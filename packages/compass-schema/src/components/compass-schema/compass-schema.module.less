@import (reference) 'mongodb-compass/src/app/styles/index.less';

// minicharts
@mc-blue0: @palette__blue--light-1;
@mc-blue1: lighten(@mc-blue0, 7.5%);
@mc-blue2: lighten(@mc-blue0, 15%);
@mc-blue3: lighten(@mc-blue0, 22.5%);
@mc-blue4: lighten(@mc-blue0, 30%);
@mc-blue5: lighten(@mc-blue0, 37.5%);

@mc-bg: @palette__gray--light-3;
@mc-fg: @mc-blue0;
@mc-fg-selected: @palette__yellow--base;
@mc-fg-unselected: @palette__gray--light-2;

.root {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  flex-grow: 1;
  flex-shrink: 1;
}

.loader {
  height: 100%;
  display: flex;
  justify-content: center;
}

.schema {
  width: 100%;
  padding: 0 16px;
  flex-grow: 1;
  overflow: auto;

  &-zero-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding-top: 70px;
    padding-bottom: 20px;

    &-link {
      display: block;
      margin-top: 20px;
      font-size: 16px;
    }
  }
}

:global {
  .analysis-message {
    border-bottom: 1px solid @palette__gray--light-2;
    font-size: 13px;
    font-weight: 200;
    height: 32px;
    padding: 5px 15px 5px 15px;
    background: @palette__gray--light-3;

    &-refresh-documents {
      float: right;
      width: 28px;
      padding: 0;
    }
  }
}

:global {
  .schema-field-list {
    // .list-group;
    .schema-field {
      // .list-group-item;
      padding: 24px 0 0 0;
      margin-bottom: 8px;
      background: @palette__white;
      transition: all 250ms ease-out;

      .row {
        margin-bottom: 24px;
      }

      .schema-field-type-list {
        padding-left: 24px;
      }

      .schema-field-name {
        padding-left: 24px;
      }

      .array-subtypes {
        .schema-field-type-list {
          padding-left: 0px !important;
        }
      }

      .schema-field {
        // second level
        margin-bottom: 4px;
        animation-duration: 250ms;
        position: relative;
        animation-name: fadein;
        @keyframes fadein {
          from {
            left: -20px;
            opacity: 0;
          }

          to {
            left: 0px;
            opacity: 1;
          }
        }

        &:first-child {
          margin-top: 24px;
        }
        &:last-child {
          margin-bottom: 4px;
        }

        .row {
          margin-left: -39px;
        }

        .schema-field-type-list {
          padding-left: 48px;
        }
        .schema-field-name {
          padding-left: 48px;
        }
        .schema-field {
          // third level
          .schema-field-type-list {
            padding-left: 72px;
          }
          .schema-field-name {
            padding-left: 72px;
          }
          .row {
            margin-left: -63px;
          }
          .schema-field {
            // fourth level
            .schema-field-type-list {
              padding-left: 96px;
            }
            .schema-field-name {
              padding-left: 96px;
            }
            .row {
              margin-left: -87px;
            }
            .schema-field {
              // fifth level
              .schema-field-type-list {
                padding-left: 120px;
              }
              .schema-field-name {
                padding-left: 120px;
              }
              .row {
                margin-left: -111px;
              }
              .schema-field {
                // sixth level
                .schema-field-type-list {
                  padding-left: 144px;
                }
                .schema-field-name {
                  padding-left: 144px;
                }
                .row {
                  margin-left: -135px;
                }
              }
            }
          }
        }
      }

      .schema-field-name {
        display: flex;
        align-items: center;
        max-width: 100%;
      }
    }
  }
}

:global {
  .schema-field-type-list {
    border-radius: 1px;
    padding-top: 4px;

    .schema-field-wrapper {
      float: left;
      overflow: hidden;
      cursor: pointer;
      border: none;
      padding: 0;
      background: none;
      text-align: left;

      &.schema-field-type-undefined {
        cursor: default;
      }

      &.active > .schema-field-type {
        background: @palette__gray--dark-2;
      }

      &.active.selected > .schema-field-type {
        background: @palette__yellow--base;
      }

      .schema-field-type-list
        > .schema-field-wrapper:not(.active)
        > .schema-field-type {
        // nested array subtypes
        background: @palette__gray--light-1;
      }
    }

    .schema-field-type {
      height: 5px;
      margin-right: 2px;
      background: @palette__gray--light-1;
    }

    .schema-field-type-label {
      font-size: 11px;
      text-transform: lowercase;
    }

    .schema-field-type-undefined > .schema-field-type {
      background: white;
      border: 1px solid @palette__gray--light-1;
    }

    // .schema-field-type-null {
    //   background: @series-bg-1;
    // }
    // .schema-field-type-number {
    //   background: @series-bg-2;
    // }
    // .schema-field-type-long {
    //   background: @series-bg-3;
    // }
    // .schema-field-type-string {
    //   background: @series-bg-4;
    // }
    // .schema-field-type-boolean {
    //   background: @series-bg-5;
    // }
    // .schema-field-type-undefined {
    //   background: @series-bg-6;
    // }
    // .schema-field-type-date {
    //   background: @series-bg-7;
    // }
    // .schema-field-type-objectid {
    //   background: @series-bg-8;
    // }
    // .schema-field-type-array {
    //   background: @series-bg-1;
    // }
    // .schema-field-type-object {
    //   background: @series-bg-1;
    // }
  }
}

:global {
  .schema-value-list {
    // TODO .small;
    // TODO .list-unstyled;

    .schema-value-list-item {
      // TODO .badge;
      display: inline-block;
      margin-left: 5px;
      margin-right: 5px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      max-width: 100%;
    }
  }
}

:global {
  div.minichart.unique {
    font-size: 12px;

    dl.dl-horizontal {
      margin-left: -32px;
      overflow: hidden;

      display: grid;
      grid-template-columns: 36px auto;
      grid-template-areas: 'sidebar content';

      dt {
        color: @palette__gray--base;
      }
      dd {
        overflow: auto;
        max-height: 112px;

        ul li {
          margin: 5px;
          margin-top: 0;
          display: inline-block;
        }
      }
    }
  }

  .minichart-wrapper {
    svg.minichart {
      margin-left: -40px;
    }
  }

  .layer,
  .layer svg {
    position: absolute;
  }

  .layer svg.marker {
    width: 20px;
    height: 20px;

    circle {
      fill: @mc-fg;
      stroke: @palette__white;
      stroke-width: 1.5px;

      &.selected {
        fill: @mc-fg-selected;
      }
    }
  }

  .layer svg.selection {
    visibility: hidden;

    circle {
      fill: @mc-fg-selected;
      fill-opacity: 0.2;
      stroke: @mc-fg-selected;
      stroke-width: 2px;
    }
  }

  svg.minichart {
    font-size: 10px;

    text {
      fill: @palette__gray--base;
      font-weight: bold;
    }

    .glass {
      opacity: 0;
    }

    g.brush rect.extent {
      fill: @mc-fg-selected;
      fill-opacity: 0.2;
    }

    .hour,
    .weekday {
      .bar {
        cursor: default !important;
      }
    }

    .bar {
      shape-rendering: crispEdges;
      cursor: crosshair;

      rect.bg {
        fill: @mc-bg;
      }

      rect.fg {
        fill: @mc-fg;

        &.selected {
          fill: @mc-fg-selected;
        }

        &.half-selected {
          fill: @mc-fg-selected;
          mask: url(#mask-stripe);
        }

        &.unselected {
          fill: @mc-fg-unselected;
        }
      }

      &.few {
        rect {
          stroke: white;
          stroke-width: 2px;
        }

        rect.fg-0 {
          fill: @mc-blue0;
        }

        rect.fg-1 {
          fill: @mc-blue1;
        }

        rect.fg-2 {
          fill: @mc-blue2;
        }

        rect.fg-3 {
          fill: @mc-blue3;
        }

        rect.fg-4 {
          fill: @mc-blue4;
        }

        rect.fg-5 {
          fill: @mc-blue5;
        }

        rect.fg.selected {
          fill: @mc-fg-selected;
        }
        rect.fg.unselected {
          fill: @mc-fg-unselected;
        }

        text {
          fill: white;
          font-size: 12px;
        }
      }
    }

    .line {
      stroke: @mc-fg;

      &.selected {
        stroke: @mc-fg-selected;
      }
    }

    .legend {
      text {
        fill: @palette__gray--light-1;
      }

      line {
        stroke: @palette__gray--light-2;
      }
      shape-rendering: crispEdges;
    }

    .axis path,
    .axis line {
      fill: none;
      stroke: @palette__gray--light-2;
      shape-rendering: crispEdges;
    }

    .circle {
      fill: @mc-fg;
      stroke: @palette__white;
      stroke-width: 1.5px;

      &.selected {
        fill: @mc-fg-selected;
      }
    }
  }

  .tooltip-wrapper {
    line-height: 120%;
    max-width: 400px;
  }

  .map {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 100%;
    float: left;
    svg {
      position: absolute;
      width: 100%;
      height: 100%;
    }
    nav {
      position: absolute;
      top: 40px;
      left: 20px;
      z-index: 1;
    }
    #circle {
      background-color: rgba(17, 39, 51, 0.1);
      font-family: Helvetica, sans-serif;
      color: @palette__blue--light-1;
      padding: 5px 8px;
      border-radius: 3px;
      cursor: pointer;
      border: 1px solid @palette__gray--dark-4;
    }
    #circle.active {
      background-color: rgba(255, 255, 255, 0.9);
    }
  }

  .map:hover + .map-overlay {
    display: block;
  }

  .map-overlay {
    display: none;
    position: absolute;
    font-weight: bold;
    bottom: 20px;
    left: 25px;

    &-button {
      background-image: linear-gradient(-180deg, @palette__white 0%, @palette__gray--light-3 100%);
      border: 2px solid @palette__gray--light-2;
      box-shadow: inset 0 -1px 0 0 @palette__gray--light-2;
      border-radius: 5px;
      font-size: 11px;
      padding: 15px 4px;
      width: 80px;
      height: 35px;
      float: left;
    }

    &-text {
      float: left;
      margin-left: 5px;
      line-height: 35px;
    }
  }

  // -- d3-tip styling
  .d3-tip {
    z-index: 5;
    line-height: 1;
    padding: 8px;
    background: @palette__black;
    color: @palette__white;
    border-radius: 5px;
    pointer-events: none;
    font-size: 12px;
  }

  /* Creates a small triangle extender for the tooltip */
  .d3-tip:after {
    box-sizing: border-box;
    display: inline;
    font-size: 14px;
    width: 100%;
    line-height: 1;
    color: @palette__black;
    position: absolute;
    pointer-events: none;
  }

  /* Northward tooltips */
  .d3-tip.n:after {
    content: '\25BC';
    margin: -4px 0 0 0;
    top: 100%;
    left: 0;
    text-align: center;
  }

  /* Eastward tooltips */
  .d3-tip.e:after {
    content: '\25C0';
    margin: -4px 0 0 0;
    top: 50%;
    left: -8px;
  }

  /* Southward tooltips */
  .d3-tip.s:after {
    content: '\25B2';
    margin: 0 0 1px 0;
    top: -8px;
    left: 0;
    text-align: center;
  }

  /* Westward tooltips */
  .d3-tip.w:after {
    content: '\25B6';
    margin: -4px 0 0 -1px;
    top: 50%;
    left: 100%;
  }
}
