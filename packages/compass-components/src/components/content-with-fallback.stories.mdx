import { Meta, Story, Controls } from '@storybook/blocks';
import { useState } from 'react';
import { ContentWithFallback } from './content-with-fallback';
import { Button } from './leafygreen';

<Meta
  title="Components/Feedback/ContentWithFallback"
  component={ContentWithFallback}
  parameters={{ layout: 'centered' }}
  argTypes={{
    isContentReady: {
      control: 'boolean',
      description: 'Whether the content is ready to be displayed',
    },
    contentAfterFallbackTimeout: {
      control: 'number',
      description: 'Timeout before showing content after fallback (in ms)',
    },
    fallbackTimeout: {
      control: 'number',
      description: 'Timeout before showing fallback (in ms)',
    },
  }}
/>

# ContentWithFallback

The ContentWithFallback component provides a way to show a fallback UI while content is loading, with smooth transitions between states.

## Key features

- Configurable timeouts for content and fallback display
- Smooth transitions between states
- Support for animated content appearance
- Flexible content and fallback rendering

## Usage

```tsx
<ContentWithFallback
  isContentReady={isReady}
  contentAfterFallbackTimeout={200}
  fallbackTimeout={30}
  content={(shouldRender, shouldAnimate) =>
    shouldRender && (
      <div style={{ animation: shouldAnimate ? 'fadeIn 0.3s' : 'none' }}>
        <h3>Content is Ready!</h3>
        <p>This content appeared after the fallback.</p>
      </div>
    )
  }
  fallback={(shouldRender) =>
    shouldRender && (
      <div>
        <h3>Loading...</h3>
        <p>Please wait while content loads.</p>
      </div>
    )
  }
/>
```

## Examples

### Default

<Story name="Default">
  {() => {
    const [isReady, setIsReady] = useState(false);
    return (
      <div
        style={{
          width: '300px',
          height: '200px',
          border: '1px solid #ccc',
          padding: '20px',
        }}
      >
        <ContentWithFallback
          isContentReady={isReady}
          contentAfterFallbackTimeout={200}
          fallbackTimeout={30}
          content={(shouldRender, shouldAnimate) =>
            shouldRender && (
              <div
                style={{ animation: shouldAnimate ? 'fadeIn 0.3s' : 'none' }}
              >
                <h3>Content is Ready!</h3>
                <p>This content appeared after the fallback.</p>
              </div>
            )
          }
          fallback={(shouldRender) =>
            shouldRender && (
              <div>
                <h3>Loading...</h3>
                <p>Please wait while content loads.</p>
              </div>
            )
          }
        />
        <div style={{ marginTop: '20px' }}>
          <Button onClick={() => setIsReady(!isReady)}>
            {isReady ? 'Reset' : 'Load Content'}
          </Button>
        </div>
      </div>
    );
  }}
</Story>

Default usage with interactive content loading.

### With Custom Timeouts

<Story name="WithCustomTimeouts">
  {() => {
    const [isReady, setIsReady] = useState(false);
    return (
      <div
        style={{
          width: '300px',
          height: '200px',
          border: '1px solid #ccc',
          padding: '20px',
        }}
      >
        <ContentWithFallback
          isContentReady={isReady}
          contentAfterFallbackTimeout={500}
          fallbackTimeout={100}
          content={(shouldRender, shouldAnimate) =>
            shouldRender && (
              <div
                style={{ animation: shouldAnimate ? 'fadeIn 0.3s' : 'none' }}
              >
                <h3>Content is Ready!</h3>
                <p>This content appeared after the fallback.</p>
              </div>
            )
          }
          fallback={(shouldRender) =>
            shouldRender && (
              <div>
                <h3>Loading...</h3>
                <p>Please wait while content loads.</p>
              </div>
            )
          }
        />
        <div style={{ marginTop: '20px' }}>
          <Button onClick={() => setIsReady(!isReady)}>
            {isReady ? 'Reset' : 'Load Content'}
          </Button>
        </div>
      </div>
    );
  }}
</Story>

Custom timeouts for fallback and content display.

## Props

<Controls />
